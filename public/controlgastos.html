<!DOCTYPE html>
<html lang="es">
<head>
<script src="/js/auth.js"></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>INTEK-IT | Control de Gastos</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* --------------------------------------------- */
/* VARIABLES Y BASE (MISMO ESTILO QUE LICENCIAS) */
/* --------------------------------------------- */
:root {
  --bg:#f5f7fb; --white:#fff; --primary:#1e40af; --secondary:#3b82f6;
  --gray:#6b7280; --light-gray:#eef0f5; --radius:16px;
  --shadow:0 4px 18px rgba(0,0,0,0.08);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
body{background:var(--bg);display:flex;}

/* SIDEBAR */
aside{
  width:240px;
  background:linear-gradient(180deg,var(--primary),var(--secondary));
  color:white;
  padding:2rem 1rem;
  height:100vh;
  position:fixed;
}
aside .logo{
  text-align:center;
  font-size:1.6rem;
  font-weight:700;
  margin-bottom:2rem;
}
aside nav a{
  display:flex; gap:.8rem;
  padding:.7rem 1rem;
  margin-bottom:.5rem;
  border-radius:10px;
  text-decoration:none;
  color:white;
}
aside nav a:hover{ background:rgba(255,255,255,.25); }
aside nav a.active{ background:rgba(255,255,255,.35); }

/* MAIN */
.main{
  margin-left:240px;
  padding:2rem;
  width:100%;
}
.header{
  background:linear-gradient(135deg,var(--primary),var(--secondary));
  padding:1rem 2rem;
  border-radius:var(--radius);
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:white;
  box-shadow:var(--shadow);
}
.header a{
  background:rgba(255,255,255,.15);
  padding:.5rem 1rem;
  border-radius:8px;
  text-decoration:none;
  color:white;
}
.btn{
  background:var(--secondary);
  padding:.6rem 1rem;
  border:none;
  color:white;
  border-radius:10px;
  cursor:pointer;
}
.btn:hover{ opacity:.9; }

/* TABLE */
.table-container{
  margin-top:2rem;
  background:white;
  padding:1rem;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
table{ width:100%; border-collapse:collapse; }
th,td{ padding:.8rem; border-bottom:1px solid #eee; }
th{ color:var(--primary); }
tr:hover{ background:#eef4ff; cursor:pointer; }

/* MODAL */
#modalOverlay{
  position:fixed; display:none;
  width:100%; height:100%;
  top:0; left:0; background:rgba(0,0,0,.4);
  justify-content:center; align-items:center;
}
.modal{
  background:white; padding:2rem;
  width:100%; max-width:450px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
.modal input{
  width:100%; padding:.6rem;
  border:1px solid var(--light-gray);
  margin-bottom:1rem;
  border-radius:6px;
}
</style>
</head>

<body>
<script>
const user = JSON.parse(localStorage.getItem('user') || 'null');
requireAuth(['adminIT', 'manager']);
document.addEventListener('DOMContentLoaded', () => {
  if (!user) return;
  const navLinks = document.querySelectorAll('nav a');
  navLinks.forEach(link => {
    if (user.rol === 'adminIT') return; // adminIT ve todo
    if (link.href.includes('inventario.html') && !['adminIT','tecnico'].includes(user.rol)) link.style.display = 'none';
    if (link.href.includes('empleados.html') && !['adminIT','rrhh'].includes(user.rol)) link.style.display = 'none';
    if (link.href.includes('licencias.html') && !['adminIT','rrhh','manager'].includes(user.rol)) link.style.display = 'none';
    if (link.href.includes('usuarios.html') && user.rol !== 'adminIT') link.style.display = 'none';
    if (user.rol === 'manager' && !(link.href.includes('dashboard.html') || link.href.includes('controlgastos.html') || link.href.includes('licencias.html'))) link.style.display = 'none';
    if (user.rol === 'empleado' && !(link.href.includes('dashboard.html') || link.href.includes('helpdesk'))) link.style.display = 'none';
  });
  // Llamada a gastos al cargar la página
  if (typeof cargarGastos === 'function') cargarGastos();
});
</script>

<!-- SIDEBAR -->
<aside>
  <div class="logo">INTEK-IT</div>
  <nav>
    <a href="/dashboard.html"><i class="fa-solid fa-chart-line"></i> Dashboard</a>
    <a href="/inventario.html"><i class="fa-solid fa-desktop"></i> Inventario IT</a>
    <a href="/licencias.html"><i class="fa-solid fa-key"></i> Licencias</a>
    <a href="/controlgastos.html" class="active"><i class="fa-solid fa-coins"></i> Gastos</a>
    <a href="/dominios.html"><i class="fa-solid fa-globe"></i> Dominios</a>
    <a href="/empleados.html"><i class="fa-solid fa-users"></i> Empleados</a>
    <a href="#"><i class="fa-solid fa-headset"></i> Helpdesk</a>
    <a href="#" id="btnLogout"><i class="fa-solid fa-right-from-bracket"></i> Salir</a>
  </nav>
</aside>

<!-- MAIN -->
<div class="main">

  <div class="header">
    <h2><i class="fa-solid fa-coins"></i> Control de Gastos</h2>
    <button class="btn" onclick="openModal()">+ Registrar Gasto</button>
  </div>

  <!-- Tabla -->
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Concepto</th>
          <th>Monto</th>
          <th>Categoría</th>
          <th>Fecha</th>
        </tr>
      </thead>
      <tbody id="tablaGastos"></tbody>
    </table>
  </div>

</div>

<!-- MODAL -->
<div id="modalOverlay">
  <div class="modal">
    <h3>Registrar Gasto</h3>

    <label>Concepto</label>
    <input id="m_concepto" type="text">

    <label>Monto</label>
    <input id="m_monto" type="number">

    <label>Categoría</label>
    <input id="m_categoria" type="text">

    <label>Fecha</label>
    <input id="m_fecha" type="date">

    <button class="btn" onclick="guardarGasto()">Guardar</button>
    <button class="btn" style="background:#dc2626" onclick="closeModal()">Cancelar</button>
  </div>
</div>
<link src="/js/controlgastos.js"></link>
</body>
</html>
